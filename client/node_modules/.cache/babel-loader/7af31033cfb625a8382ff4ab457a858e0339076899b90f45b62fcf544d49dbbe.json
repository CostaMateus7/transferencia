{"ast":null,"code":"var _jsxFileName = \"/home/mateus/Documentos/programacao/projetosGit/transferencia/client/src/Auth/index.js\",\n  _s = $RefreshSig$();\nimport React, { createContext, useState, useEffect } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { Api, LoginApi } from \"../Services\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthContext = /*#__PURE__*/createContext();\nexport default function AuthProvider(_ref) {\n  _s();\n  let {\n    children\n  } = _ref;\n  const navigate = useNavigate();\n  const [status, setStatus] = useState('');\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n  useEffect(() => {\n    const handleLocalStorageToken = localStorage.getItem('userToken');\n    const handleLocalStorageUser = localStorage.getItem('userName');\n    if (handleLocalStorageUser && handleLocalStorageToken) {\n      setUser(handleLocalStorageUser);\n      Api.defaults.headers.Authorization = `Bearer ${handleLocalStorageToken}`;\n    }\n    setLoading(false);\n  }, []);\n  const login = async (username, password) => {\n    try {\n      const response = await LoginApi(username, password);\n      const data = await response.data;\n      if (!data.token) {\n        return setStatus(data);\n      }\n      const {\n        token\n      } = data;\n      localStorage.setItem('userToken', token);\n      localStorage.setItem('userAccountId', data.account_id);\n      localStorage.setItem('userName', data.username);\n      localStorage.setItem('balance', data.balance);\n      Api.defaults.headers.Authorization = `Bearer ${token}`;\n      setUser(data.username);\n      return navigate(`/usuario`);\n    } catch (error) {\n      return setStatus(error.response.data);\n    }\n  };\n  const logout = () => {\n    localStorage.removeItem('userToken');\n    localStorage.removeItem('userName');\n    localStorage.removeItem('userAccountId');\n    Api.defaults.headers.Authorization = `Bearer ${null}`;\n    setUser(null);\n    navigate('/login');\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      authenticated: !!user,\n      login,\n      logout,\n      user,\n      loading,\n      status,\n      setStatus\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 60,\n    columnNumber: 5\n  }, this);\n}\n_s(AuthProvider, \"deFAYtx0j50RPdiH1rvYJxVNNEI=\", false, function () {\n  return [useNavigate];\n});\n_c = AuthProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","createContext","useState","useEffect","useNavigate","Api","LoginApi","AuthContext","AuthProvider","children","navigate","status","setStatus","user","setUser","loading","setLoading","handleLocalStorageToken","localStorage","getItem","handleLocalStorageUser","defaults","headers","Authorization","login","username","password","response","data","token","setItem","account_id","balance","error","logout","removeItem","authenticated"],"sources":["/home/mateus/Documentos/programacao/projetosGit/transferencia/client/src/Auth/index.js"],"sourcesContent":["import React, { createContext, useState, useEffect} from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { Api, LoginApi } from \"../Services\";\n\nexport const AuthContext = createContext()\n\nexport default function AuthProvider({children}){\n  const navigate = useNavigate()\n  const [ status, setStatus] = useState('');\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true); \n\n  useEffect(()=>{\n    const handleLocalStorageToken = localStorage.getItem('userToken')\n    const handleLocalStorageUser = localStorage.getItem('userName')\n    if(handleLocalStorageUser && handleLocalStorageToken){\n     setUser(handleLocalStorageUser)\n     Api.defaults.headers.Authorization = `Bearer ${handleLocalStorageToken}`;\n    }\n    setLoading(false)\n    \n  },[])\n\n\n  const login = async (username, password) =>{\n  \n  try{\n  const response = await LoginApi(username, password)\n  const data = await response.data\n  \n\n  if(!(data.token)){\n    return setStatus(data)\n  }\n  const { token } = data\n  localStorage.setItem('userToken', token)\n  localStorage.setItem('userAccountId', data.account_id)\n  localStorage.setItem('userName', data.username)\n  localStorage.setItem('balance', data.balance)\n  Api.defaults.headers.Authorization = `Bearer ${token}`;\n  setUser(data.username)\n  return navigate(`/usuario`)\n  }\n  catch(error){\n    return setStatus(error.response.data)\n  }\n} \n\n\n\nconst logout = ()=>{\n  localStorage.removeItem('userToken')\n  localStorage.removeItem('userName')\n  localStorage.removeItem('userAccountId')\n  Api.defaults.headers.Authorization = `Bearer ${null}`;\n  setUser(null)\n  navigate('/login')\n}\n  return(\n    <AuthContext.Provider value={{\n      authenticated:!!user, login, logout, user, loading, status, setStatus \n      }}>\n      {children}\n    </AuthContext.Provider>\n  )\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}