{"ast":null,"code":"var _jsxFileName = \"/home/mateus/Documentos/programacao/projetosGit/transferencia/client/src/Auth/index.js\",\n  _s = $RefreshSig$();\nimport React, { createContext, useState, useEffect } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { Api } from \"../Services\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthContext = /*#__PURE__*/createContext();\nexport default function AuthProvider(_ref) {\n  _s();\n  let {\n    children\n  } = _ref;\n  const navigate = useNavigate();\n  const [status, setStatus] = useState('');\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n  useEffect(() => {\n    const handleLocalStorage = localStorage.getItem('userToken');\n    if (handleLocalStorage) {\n      setUser(JSON.parse(handleLocalStorage));\n    }\n    setLoading(false);\n  }, []);\n  const login = async (username, password) => {\n    try {\n      const init = {\n        method: 'POST',\n        headers: {\n          \"Content-Type\": 'application/json'\n        },\n        body: JSON.stringify({\n          username: username,\n          password: password\n        })\n      };\n      const response = await fetch(\"http://localhost:8080/login\", init);\n      const data = await response.json();\n      if (!data.token) {\n        return setStatus(data);\n      }\n      const {\n        token\n      } = data;\n      localStorage.setItem('userToken', JSON.stringify(token));\n      localStorage.setItem('user', JSON.stringify(data.username));\n      AuthJWT();\n      // Api.defaults.headers.Authorization = `Bearer ${token}`;\n      setUser(data.username);\n      return navigate('/usuario');\n    } catch (error) {\n      return setStatus(error.response.data);\n    }\n  };\n  const AuthJWT = async () => {\n    const headers = {\n      'Content-Type': 'application/json'\n    };\n    if (localStorage.getItem('userToken')) {\n      headers.append('Authorization', 'Bearer ' + localStorage.getItem('userToken'));\n    }\n    return await fetch('http://localhost:8080', {\n      method: 'POST',\n      headers: headers\n    }).then(res => console.log(res));\n  };\n  const logout = () => {\n    localStorage.removeItem('userToken');\n    localStorage.removeItem('user');\n    Api.defaults.headers.Authorization = `Bearer ${null}`;\n    setUser(null);\n    navigate('/login');\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      authenticated: !!user,\n      login,\n      logout,\n      user,\n      loading,\n      status,\n      setStatus\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 79,\n    columnNumber: 5\n  }, this);\n}\n_s(AuthProvider, \"deFAYtx0j50RPdiH1rvYJxVNNEI=\", false, function () {\n  return [useNavigate];\n});\n_c = AuthProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","createContext","useState","useEffect","useNavigate","Api","AuthContext","AuthProvider","children","navigate","status","setStatus","user","setUser","loading","setLoading","handleLocalStorage","localStorage","getItem","JSON","parse","login","username","password","init","method","headers","body","stringify","response","fetch","data","json","token","setItem","AuthJWT","error","append","then","res","console","log","logout","removeItem","defaults","Authorization","authenticated"],"sources":["/home/mateus/Documentos/programacao/projetosGit/transferencia/client/src/Auth/index.js"],"sourcesContent":["import React, { createContext, useState, useEffect} from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { Api } from \"../Services\";\n\nexport const AuthContext = createContext()\n\nexport default function AuthProvider({children}){\n  const navigate = useNavigate()\n  const [ status, setStatus] = useState('');\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true); \n\n  useEffect(()=>{\n    const handleLocalStorage = localStorage.getItem('userToken')\n    if(handleLocalStorage){\n     setUser(JSON.parse(handleLocalStorage))\n    }\n    setLoading(false)\n    \n  },[])\n\n\n  const login = async (username, password) =>{\n  \n  try{\n  const init = {\n    method: 'POST', \n    headers: {\n      \"Content-Type\":'application/json'\n    },\n    body: JSON.stringify({\n      username: username,\n      password: password\n    })\n  }\n  const response = await fetch(\"http://localhost:8080/login\", init)\n  const data = await response.json()\n\n  if(!(data.token)){\n    return setStatus(data)\n  }\n  const { token } = data\n  localStorage.setItem('userToken', JSON.stringify(token))\n  localStorage.setItem('user', JSON.stringify(data.username))\n  AuthJWT()\n  // Api.defaults.headers.Authorization = `Bearer ${token}`;\n  setUser(data.username)\n  return navigate('/usuario')\n  }\n  catch(error){\n    return setStatus(error.response.data)\n  }\n} \nconst AuthJWT = async ()=>{\n  const headers = {\n    'Content-Type': 'application/json',\n}\n\nif(localStorage.getItem('userToken')) {\n    headers.append('Authorization', 'Bearer ' + localStorage.getItem('userToken'))\n\n}\n\nreturn await fetch('http://localhost:8080', {\n    method: 'POST',\n    headers: headers,\n})\n.then(res => console.log(res));\n}\n\nconst logout = ()=>{\n  localStorage.removeItem('userToken')\n  localStorage.removeItem('user')\n  Api.defaults.headers.Authorization = `Bearer ${null}`;\n  setUser(null)\n  navigate('/login')\n}\n  return(\n    <AuthContext.Provider value={{\n      authenticated:!!user, login, logout, user, loading, status, setStatus \n      }}>\n      {children}\n    </AuthContext.Provider>\n  )\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}